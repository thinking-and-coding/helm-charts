Thank you for installing {{ .Chart.Name }}!

Your release is named {{ .Release.Name }}.

To learn more about the release, try:

  $ helm status {{ .Release.Name }}
  $ helm get all {{ .Release.Name }}

{{- if .Values.ingress.enabled }}

Your DocETL application is accessible via Ingress:

{{- range .Values.ingress.hosts }}
  http{{ if $.Values.ingress.tls.enabled }}s{{ end }}://{{ .host }}
{{- end }}

{{- if not .Values.ingress.tls.enabled }}
NOTE: TLS is not enabled. Consider enabling it for production use.
{{- end }}

{{- else }}

To access your DocETL application:

1. Get the backend service URL:
   {{- if contains "NodePort" .Values.backend.service.type }}
   export NODE_PORT=$(kubectl get --namespace {{ .Release.Namespace }} -o jsonpath="{.spec.ports[0].nodePort}" services {{ include "docetl.fullname" . }}-backend)
   export NODE_IP=$(kubectl get nodes --namespace {{ .Release.Namespace }} -o jsonpath="{.items[0].status.addresses[0].address}")
   echo "Backend: http://$NODE_IP:$NODE_PORT"
   {{- else if contains "LoadBalancer" .Values.backend.service.type }}
   export SERVICE_IP=$(kubectl get svc --namespace {{ .Release.Namespace }} {{ include "docetl.fullname" . }}-backend --template "{{"{{ range (index .status.loadBalancer.ingress 0) }}{{.}}{{ end }}"}}")
   echo "Backend: http://$SERVICE_IP:{{ .Values.backend.service.port }}"
   {{- else if contains "ClusterIP" .Values.backend.service.type }}
   kubectl port-forward --namespace {{ .Release.Namespace }} svc/{{ include "docetl.fullname" . }}-backend {{ .Values.backend.service.port }}:{{ .Values.backend.service.port }}
   echo "Backend: http://127.0.0.1:{{ .Values.backend.service.port }}"
   {{- end }}

2. Get the frontend service URL:
   {{- if contains "NodePort" .Values.frontend.service.type }}
   export NODE_PORT=$(kubectl get --namespace {{ .Release.Namespace }} -o jsonpath="{.spec.ports[0].nodePort}" services {{ include "docetl.fullname" . }}-frontend)
   export NODE_IP=$(kubectl get nodes --namespace {{ .Release.Namespace }} -o jsonpath="{.items[0].status.addresses[0].address}")
   echo "Frontend: http://$NODE_IP:$NODE_PORT"
   {{- else if contains "LoadBalancer" .Values.frontend.service.type }}
   export SERVICE_IP=$(kubectl get svc --namespace {{ .Release.Namespace }} {{ include "docetl.fullname" . }}-frontend --template "{{"{{ range (index .status.loadBalancer.ingress 0) }}{{.}}{{ end }}"}}")
   echo "Frontend: http://$SERVICE_IP:{{ .Values.frontend.service.port }}"
   {{- else if contains "ClusterIP" .Values.frontend.service.type }}
   kubectl port-forward --namespace {{ .Release.Namespace }} svc/{{ include "docetl.fullname" . }}-frontend {{ .Values.frontend.service.port }}:{{ .Values.frontend.service.port }}
   echo "Frontend: http://127.0.0.1:{{ .Values.frontend.service.port }}"
   {{- end }}
{{- end }}

Check the status of your pods:

  $ kubectl get pods --namespace {{ .Release.Namespace }} -l "app.kubernetes.io/instance={{ .Release.Name }}"

View logs:

  Backend:  $ kubectl logs --namespace {{ .Release.Namespace }} -l "app.kubernetes.io/component=backend" -f
  Frontend: $ kubectl logs --namespace {{ .Release.Namespace }} -l "app.kubernetes.io/component=frontend" -f

{{- if not (contains "your_api_key_here" .Values.secrets.openaiApiKey) }}
{{- else }}

WARNING: You are using the default OpenAI API key placeholder.
Please update the secret with your actual API key:

  $ kubectl create secret generic {{ include "docetl.fullname" . }}-secret \
      --from-literal=openai-api-key=YOUR_ACTUAL_API_KEY \
      --namespace {{ .Release.Namespace }} \
      --dry-run=client -o yaml | kubectl apply -f -

Then restart the backend pods:

  $ kubectl rollout restart deployment/{{ include "docetl.fullname" . }}-backend --namespace {{ .Release.Namespace }}
{{- end }}

For more information, visit: https://docetl.org
